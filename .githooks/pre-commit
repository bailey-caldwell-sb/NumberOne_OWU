#!/bin/bash
# NumberOne OWU Pre-commit Hook

echo "Running pre-commit checks..."

# Check for secrets in staged files
if git diff --cached --name-only | xargs grep -l "api.*key\|secret\|password" 2>/dev/null; then
    echo "❌ Potential secrets detected in staged files!"
    echo "Please review and remove any sensitive information."
    exit 1
fi

# Check for large files
large_files=$(git diff --cached --name-only | xargs ls -la 2>/dev/null | awk '$5 > 100000000 {print $9}')
if [ -n "$large_files" ]; then
    echo "❌ Large files detected (>100MB):"
    echo "$large_files"
    echo "Please use Git LFS for large files."
    exit 1
fi

echo "✅ Pre-commit checks passed"
